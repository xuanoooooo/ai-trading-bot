# 配置文件说明

## coins_config.json

### 币种配置 (coins)

每个币种包含以下参数：

| 参数 | 说明 | 示例 |
|------|------|------|
| `symbol` | 币种代码 | `"BTC"` |
| `binance_symbol` | 币安交易对 | `"BTCUSDT"` |
| `precision` | 数量精度（小数位数） | `3` = 0.001 BTC |
| `price_precision` | 价格精度（止损价格小数位数） | `2` = 保留2位小数 |
| `min_order_value` | 最小开仓金额（USDT） | `50` = 最少50 USDT |

**注意事项**：
- `precision` 必须符合币安要求，否则下单会被拒绝
- `min_order_value` 必须 ≥ 13 USDT（全局硬编码限制）
- 低价币（XRP、ADA、DOGE）需要更高的 `price_precision`（建议4位）

---

### 投资组合规则 (portfolio_rules)

| 参数 | 说明 | 默认值 | 可选值 |
|------|------|--------|--------|
| `leverage` | 杠杆倍数（全局设置） | `5` | 1-125 |
| `min_cash_reserve_percent` | 强制保留的资金比例 | `10` | 5-20 |
| `check_interval_minutes` | AI决策间隔（分钟） | `5` | 1-60 |

**参数详解**：

#### leverage（杠杆倍数）
- 程序启动时自动设置到币安账户
- 所有币种使用统一杠杆
- 修改后需重启程序生效
- **建议值**：3-10x（风险可控）

#### min_cash_reserve_percent（资金保留比例）
- 强制保留一定比例的资金作为缓冲
- 最大可用保证金 = 总资产 × (100 - 此值)% - 已用保证金
- 用于支付手续费和应对突发波动
- **建议值**：10%（默认）

#### check_interval_minutes（AI决策间隔）
- 控制多久调用一次 AI 进行决策
- 间隔越短，交易越频繁
- **建议值**：
  - `1-3` 分钟：激进，适合高频交易
  - `5` 分钟：平衡（默认）
  - `10-15` 分钟：稳健，适合趋势跟踪

---

## 配置示例

### 完整配置
```json
{
  "coins": [
    {
      "symbol": "BTC",
      "binance_symbol": "BTCUSDT",
      "precision": 3,
      "price_precision": 2,
      "min_order_value": 50
    },
    {
      "symbol": "ETH",
      "binance_symbol": "ETHUSDT",
      "precision": 3,
      "price_precision": 2,
      "min_order_value": 24
    }
  ],
  "portfolio_rules": {
    "leverage": 5,
    "min_cash_reserve_percent": 10,
    "check_interval_minutes": 5
  }
}
```

### 激进配置（高频交易）
```json
{
  "portfolio_rules": {
    "leverage": 10,
    "min_cash_reserve_percent": 15,
    "check_interval_minutes": 1
  }
}
```

### 保守配置（稳健交易）
```json
{
  "portfolio_rules": {
    "leverage": 3,
    "min_cash_reserve_percent": 20,
    "check_interval_minutes": 15
  }
}
```

---

## 修改配置

### 步骤
1. 编辑配置文件：`vim config/coins_config.json`
2. 修改对应参数
3. 保存退出
4. 重启程序：`pkill -f portfolio_manager.py && ./start_portfolio.sh`

### 注意事项
- 修改杠杆后，程序会自动设置到币安
- 如果有持仓，修改杠杆可能会失败
- 建议在无持仓时修改配置

---

## 常见问题

### Q: 修改配置后没生效？
A: 确保已重启程序，配置只在启动时读取一次。

### Q: 杠杆设置失败？
A: 检查是否有持仓，建议平仓后再修改杠杆。

### Q: 最小开仓金额设置太低被拒绝？
A: 全局最小限制是 13 USDT，任何币种都不能低于此值。

### Q: 精度设置错误导致下单失败？
A: 参考币安官方文档，或查看日志中的错误提示，调整 `precision` 和 `price_precision`。
